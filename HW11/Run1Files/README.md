Update to run by number of episodes. Max training size 50000
